(function(y,u,R,s,C,S,l,p,A,v){"use strict";const{Text:G}=C.General,L=s.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:U}}=s.findByProps("colors","meta"),$=s.findByStoreName("UserStore"),F=s.findByStoreName("RelationshipStore"),j=s.findByStoreName("GuildMemberStore"),D=s.findByProps("TYPING_WRAPPER_HEIGHT");function H(){return R.after("default",D,function(e,o){let[{channel:n}]=e;if(!o||l.storage.hideTyping)return;const i=o.props?.children,h=U(L.theme,S.semanticColors.HEADER_SECONDARY),g=R.after("type",i,function(d,f){u.React.useEffect(function(){return function(){g()}},[]);const c=f?.props?.children?.[0]?.props?.children?.[1]?.props;if(!c||!c.children||c.children==="Several people are typing...")return;const r=D.useTypingUserIds(n.id).map(function(t){const a=j.getMember(n.guild_id,t),B=$.getUser(t),w=a?.nick||F.getNickname(t)||B.globalName||B.username,O=a?.colorString||h;return{displayName:w,displayColor:O}});function m(t){return u.React.createElement(G,{style:{color:t.displayColor,fontFamily:u.constants.Fonts.DISPLAY_BOLD}},t.displayName)}!r||r.length<1||(c.children=r.length===1?[m(r[0])," is typing..."]:[...r.slice(0,r.length-1).flatMap(function(t,a){return[m(t),a<r.length-2?", ":" and "]}),m(r[r.length-1])," are typing..."])})})}const{DCDChatManager:V}=u.ReactNative.NativeModules,Y=s.findByStoreName("GuildMemberStore"),k=s.findByStoreName("SelectedChannelStore"),W=s.findByStoreName("ChannelStore");function E(e,o){if(e)return Array.isArray(e.content)&&e.content.forEach(function(n,i){return e.content[i]=E(n,o)}),e.type&&(e=o(e)||e),e}function K(){return R.before("updateRows",V,function(e){if(l.storage.noMention)return;let o=JSON.parse(e[1]);o.forEach(function(n){if(n.type!=1||!n.message?.content)return;const i=k.getChannelId();if(!i)return;const h=W.getChannel(i);if(!h.guild_id)return;const g=function(d){if(d.type!="mention"||!d.userId)return;const f=Y.getMember(h.guild_id,d.userId)?.colorString;if(!f)return;const c=parseInt(f.slice(1),16);return{...d,roleColor:c,color:c,colorString:f}};E({content:n.message.content},g),n.message.referencedMessage?.message?.content&&E({content:n.message.referencedMessage.message.content},g)}),e[1]=JSON.stringify(o)})}function N(){return N=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},N.apply(this,arguments)}function J(){return N.apply(this,arguments)}console.log("S1");const{StyleSheet:X,PanResponder:q}=u.ReactNative,b=s.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:I}}=s.findByProps("colors","meta"),{View:M}=C.General,{useState:z,useRef:Q}=u.React;console.log("S2");const T={sliderOff:I(b.theme,S.semanticColors.DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND),sliderOn:I(b.theme,S.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND),thumb:I(b.theme,S.semanticColors.MENTION_FOREGROUND)};console.log("S3");const Z=function(e){let{onSlide:o,value:n}=e;console.log("S4");const i=n||0,[h,g]=z(0),d=Q(null);function f(t){d.measure(function(a,B,w,O,x,le){let ce=(t-x)/(w-x)*100;const se=Math.min(Math.max(0,ce),100);o&&o(se)})}const c=u.React.useRef(q.create({onStartShouldSetPanResponder:function(t,a){return!0},onStartShouldSetPanResponderCapture:function(t,a){return!0},onMoveShouldSetPanResponder:function(t,a){return!0},onMoveShouldSetPanResponderCapture:function(t,a){return!0},onPanResponderGrant:function(t,a){f(a.x0)},onPanResponderMove:function(t,a){f(a.moveX)},onPanResponderTerminationRequest:function(t,a){return!0},onPanResponderRelease:function(t,a){},onPanResponderTerminate:function(t,a){},onShouldBlockNativeResponder:function(t,a){return!0}})).current;function r(t){g(t.nativeEvent.layout.width)}const m=X.create({container:{marginLeft:"5%",width:"90%",height:20,borderRadius:25,backgroundColor:T.sliderOff,marginBottom:25},slid:{width:i+"%",height:"100%",borderTopLeftRadius:25,borderBottomLeftRadius:25,borderRadius:i===100?25:0,backgroundColor:T.sliderOn,justifyContent:"center"},thumb:{height:"150%",aspectRatio:1,alignSelf:"flex-end",right:-(h/2),borderRadius:100,backgroundColor:T.thumb}});return u.React.createElement(M,J({style:m.container},c.panHandlers,{ref:d}),u.React.createElement(M,{style:m.slid},u.React.createElement(M,{style:m.thumb,onLayout:r})))};console.log("S5"),console.log("is it this..?");const{Text:ee}=C.General,te=s.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:ne}}=s.findByProps("colors","meta"),_={Typing:v.getAssetIDByName("ic_messages"),Mention:v.getAssetIDByName("ic_mention_user"),Text:v.getAssetIDByName("ic_add_text")},oe={text:ne(te.theme,S.semanticColors.TEXT_NORMAL)};function re(e,o,n){const i=function(c){return c.match(/\w\w/g).map(function(r){return parseInt(r,16)})},h=function(c){return"#"+c.map(function(r){return r.toString(16).padStart(2,"0")}).join("")},g=i(e),d=i(o),f=g.map(function(c,r){return Math.round(c+(d[r]-c)*n)});return h(f)}function ae(){return A.useProxy(l.storage),l.storage.chatInterpolation??=0,React.createElement(u.ReactNative.ScrollView,{style:{flex:1}},React.createElement(p.FormSection,{title:"Where to show the top role color?",titleStyleType:"no_border"},React.createElement(p.FormSwitchRow,{label:"Show in typing",subLabel:"Display the top role color in the typing bar.",leading:React.createElement(p.FormIcon,{source:_.Typing}),value:!l.storage.hideTyping,onValueChange:function(e){return l.storage.hideTyping=!e}}),React.createElement(p.FormSwitchRow,{label:"Show in mentions",subLabel:"Display the top role color in mentions in the chat.",leading:React.createElement(p.FormIcon,{source:_.Mention}),value:!l.storage.noMention,onValueChange:function(e){return l.storage.noMention=!e}}),React.createElement(p.FormSwitchRow,{label:"Show in chat text",subLabel:"Display the top role color in the chat text... Why would you want this?",leading:React.createElement(p.FormIcon,{source:_.Typing}),value:l.storage.chatInterpolation>0,onValueChange:function(e){l.storage.chatInterpolation=e?100:0}}),React.createElement(ee,{style:{marginLeft:"5%",color:re(oe.text,"#ff0000",l.storage.chatInterpolation/100),fontFamily:u.constants.Fonts.DISPLAY_MEDIUM,fontSize:16,marginBottom:5,marginTop:-5}},"Color interpolation (for chat text):"),React.createElement(Z,{onSlide:function(e){l.storage.chatInterpolation=e},value:l.storage.chatInterpolation})))}let P=[];var ie={onLoad:function(){P.push(H()),P.push(K())},onUnload:function(){for(const e of P)e()},settings:ae};return y.default=ie,Object.defineProperty(y,"__esModule",{value:!0}),y})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta.ui.components,vendetta.ui,vendetta.plugin,vendetta.ui.components.Forms,vendetta.storage,vendetta.ui.assets);
