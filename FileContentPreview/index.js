(function(x,n,I,h,d,y,e,B,C,X,q){"use strict";var S={PREVIEW:{"en-US":"Preview","en-GB":"Preview","zh-CN":"\u9884\u89C8","zh-TW":"\u9810\u89BD",ch:"N\xE1hled",da:"L\xE6s fil",nl:"Voorbeeld",fr:"Aper\xE7u",de:"Vorschau",el:"\u03B4\u03B9\u03B1\u03B2\u03AC\u03C3\u03B5\u03C4\u03B5","es-ES":"Leer",uk:"\u0447\u0438\u0442\u0430\u0442\u0438"},FILE_SAVED:{"en-US":"File saved","en-GB":"File saved","es-ES":"Archivo guardado",uk:"\u0424\u0430\u0439\u043B \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E"},FILE_SAVE_ERROR:{"en-US":"Error saving file","en-GB":"Error saving file","es-ES":"Error guardando archivo",uk:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043D\u044F \u0444\u0430\u0439\u043B\u0443"},TOGGLE_WORD_WRAP:{"en-US":"Toggle Word Wrap","en-GB":"Toggle Word Wrap","es-ES":"Salto de l\xEDnea",uk:"\u041F\u0435\u0440\u0435\u043C\u0438\u043A\u0430\u0447 \u0430\u0432\u0442\u043E\u043F\u0435\u0440\u0435\u043D\u043E\u0441\u0443 \u0441\u043B\u043E\u0432"},JUMP_BOTTOM:{"en-US":"Jump to the bottom","en-GB":"Jump to the bottom","es-ES":"Saltar al final",uk:"\u041F\u0440\u043E\u043A\u0440\u0443\u0442\u0456\u0442\u044C \u0434\u043E \u043D\u0438\u0437\u0443"},JUMP_TOP:{"en-US":"Jump to the top","en-GB":"Jump to the top","es-ES":"Saltar al principio",uk:"\u041F\u0440\u043E\u043A\u0440\u0443\u0442\u0456\u0442\u044C \u0434\u043E \u0432\u0435\u0440\u0445\u0443"}};const b=n.findByProps("Messages"),{getLocale:D}=n.findByProps("getLocale"),m=n.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:T}}=n.findByProps("colors","meta"),{View:g,Text:_,TouchableOpacity:p}=B.General,{FormIcon:N}=B.Forms,{ActivityIndicator:Z,ScrollView:V,Image:Q,Modal:ee}=e.ReactNative,te=e.ReactNative.NativeModules.MediaManager.downloadMediaAsset,{default:ne,getRenderCloseButton:ae}=n.findByProps("getRenderCloseButton"),$=n.findByProps("pushModal"),J=n.findByProps("intword"),re=n.findByName("Svg",!1).default,L=n.findByName("Svg",!1).Path,oe=n.findByProps("useSafeAreaInsets");function ie(u,a){return function(){return e.React.createElement(p,{onPress:u,onLongPress:a},e.React.createElement(N,{source:d.getAssetIDByName("ic_download_24px"),style:{marginRight:8,marginLeft:-8,opacity:1}}))}}function se(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"https://cdn.discordapp.com/attachments/1068304660269641738/1144843403151020122/file.txt",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return function(){let o=C.storage.chunkSize||60928;const[r,i]=e.React.useState({content:"",loadedBytes:o,firstTime:!0});r.firstTime&&fetch(a,{headers:{Range:"bytes=0-"+String(o)}}).then(function(s){s.ok?s.text().then(function(A){i({content:A,loadedBytes:r.loadedBytes,firstTime:!1})}):i({content:"",loadedBytes:0,firstTime:!1})});let c=e.React.createElement(g,{style:{margin:32}},e.React.createElement(Z,{size:"large"}));const[R,M]=e.React.useState(!1),[w,E]=e.React.useState([]),t={header:T(m.theme,h.semanticColors.HEADER_PRIMARY),test:T(m.theme,h.semanticColors.TEXT_MUTED),bgDark:T(m.theme,h.semanticColors.BACKGROUND_SECONDARY_ALT),bgBright:T(m.theme,h.semanticColors.BACKGROUND_SECONDARY),bgBrighter:T(m.theme,h.semanticColors.BACKGROUND_ACCENT)},l=e.React.createElement(re,{height:"24",width:"24",viewBox:"0 0 24 24",fill:R?t.header:t.test},e.React.createElement(L,{d:"M2.75 5C2.33579 5 2 5.33579 2 5.75C2 6.16421 2.33579 6.5 2.75 6.5H21.25C21.6642 6.5 22 6.16421 22 5.75C22 5.33579 21.6642 5 21.25 5H2.75Z"}),e.React.createElement(L,{d:"M2.75 11.5C2.33579 11.5 2 11.8358 2 12.25C2 12.6642 2.33579 13 2.75 13H19C20.3807 13 21.5 14.1193 21.5 15.5C21.5 16.8807 20.3807 18 19 18H14.5607L15.2803 17.2803C15.5732 16.9874 15.5732 16.5126 15.2803 16.2197C14.9874 15.9268 14.5126 15.9268 14.2197 16.2197L12.2197 18.2197C11.9268 18.5126 11.9268 18.9874 12.2197 19.2803L14.2197 21.2803C14.5126 21.5732 14.9874 21.5732 15.2803 21.2803C15.5732 20.9874 15.5732 20.5126 15.2803 20.2197L14.5607 19.5H19C21.2091 19.5 23 17.7091 23 15.5C23 13.2909 21.2091 11.5 19 11.5H2.75Z"}),e.React.createElement(L,{d:"M2 18.75C2 18.3358 2.33579 18 2.75 18H9.25C9.66421 18 10 18.3358 10 18.75C10 19.1642 9.66421 19.5 9.25 19.5H2.75C2.33579 19.5 2 19.1642 2 18.75Z"}));let j=e.React.createElement(e.React.Fragment,null,e.React.createElement(_,{style:{color:t.test,marginTop:7}},"+ ",J.intword(f-r.loadedBytes,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")," not loaded."),e.React.createElement(p,{style:{backgroundColor:t.bgBright,borderRadius:5,padding:10,marginBottom:20,marginTop:5},onPress:function(){fetch(a,{headers:{Range:"bytes="+String(r.loadedBytes+1)+"-"+String(r.loadedBytes+o)}}).then(function(s){s.ok?s.text().then(function(A){i({content:r.content+A,loadedBytes:r.loadedBytes+o,firstTime:!1})}):y.showToast("Error: Network response was not ok",d.getAssetIDByName("ic_close_circle"))})}},e.React.createElement(_,{style:{color:t.header,textTransform:"uppercase",fontWeight:"bold",textAlign:"center",fontSize:20}},b.Messages.VOICE_PANEL_LOAD_MORE)));const[W,P]=e.React.useState(!1),v=e.React.useRef(null),Y=oe.useSafeAreaInsets();let z=0,H=e.React.createElement(g,{style:{marginTop:0}},e.React.createElement(g,{style:{padding:15,paddingBottom:0,display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}},e.React.createElement(g,{style:{display:"flex",flexDirection:"row"}},e.React.createElement(p,{onPress:function(){M(!R)},onLongPress:function(){y.showToast(S.TOGGLE_WORD_WRAP[D()]??"Toggle Word Wrap",d.getAssetIDByName("ic_information_filled_24px"))},style:{backgroundColor:R?t.bgBrighter:t.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:R?t.bgBright:t.bgDark}},l),e.React.createElement(p,{onPress:function(){P(!0)},onLongPress:function(){y.showToast(b.Messages.JUMP,d.getAssetIDByName("ic_information_filled_24px"))},style:{marginLeft:10,backgroundColor:t.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:t.bgDark}},e.React.createElement(Q,{source:d.getAssetIDByName("ic_reply_24px"),style:{height:24,width:24,transform:[{scaleX:-1},{rotate:"-90deg"}]}})))),e.React.createElement(V,{ref:v,style:{margin:15,marginBottom:50+Y.bottom}},e.React.createElement(V,{horizontal:!R},e.React.createElement(g,{style:{flexDirection:"row"}},e.React.createElement(g,{style:{borderTopLeftRadius:4,borderBottomLeftRadius:4,backgroundColor:t.bgDark,marginRight:5,paddingRight:2,paddingLeft:2,alignSelf:"flex-start"}},e.React.createElement(_,{style:{textAlign:"right",color:t.test,lineHeight:20}},w.map(function(s){return s?++z:" "}).join(`
`))),e.React.createElement(_,{selectable:!0,style:{color:t.header,lineHeight:20,flex:1},onTextLayout:function(s){let A=s.nativeEvent.lines;E(A.map(function(De,K){return K>0?A[K-1].text.indexOf(`
`)>-1:!0}))}},r.content))),r.loadedBytes<f&&j),e.React.createElement(ee,{transparent:!0,animationType:"none",visible:W,onRequestClose:function(){return P(!1)}},e.React.createElement(g,{style:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"}},e.React.createElement(g,{style:{backgroundColor:t.bgBright,padding:20,borderRadius:10,width:"90%"}},e.React.createElement(g,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15}},e.React.createElement(B.Forms.FormText,{style:{fontSize:20,fontFamily:e.constants.Fonts.PRIMARY_BOLD}},b.Messages.JUMP),e.React.createElement(p,{onPress:function(){return P(!1)}},e.React.createElement(N,{source:d.getAssetIDByName("ic_close_16px"),style:{opacity:1}}))),e.React.createElement(p,{style:{backgroundColor:t.bgDark,borderRadius:5,padding:10,marginBottom:15,marginTop:5,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},onPress:function(){let s=v?.current;P(!1),s?.scrollToEnd?.({animated:!0})}},e.React.createElement(N,{source:d.getAssetIDByName("ic_jump_to_bottom_24px"),style:{opacity:1}}),e.React.createElement(B.Forms.FormText,{style:{color:t.test,fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_BOLD,textTransform:"uppercase"}},S.JUMP_BOTTOM[D()]??"Jump to the bottom"),e.React.createElement(g,null)),e.React.createElement(p,{style:{backgroundColor:t.bgDark,borderRadius:5,padding:10,marginBottom:10,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},onPress:function(){let s=v?.current;P(!1),s?.scrollTo?.({y:0,animated:!0})}},e.React.createElement(N,{source:d.getAssetIDByName("ic_jump_to_bottom_24px"),style:{opacity:1,transform:[{scaleY:-1}]}}),e.React.createElement(B.Forms.FormText,{style:{color:t.test,fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_BOLD,textTransform:"uppercase"}},S.JUMP_TOP[D()]??"Jump to the top"),e.React.createElement(g,null))))));return e.React.createElement(ne,{initialRouteName:"FILE_CONTENT_PREVIEW",screens:{FILE_CONTENT_PREVIEW:{headerLeft:ae(function(){return $.popModal("file-content-preview")}),headerRight:ie(function(){te(a,0).then(function(s){s?y.showToast(S.FILE_SAVED[D()]??"File saved",d.getAssetIDByName("ic_selection_checked_24px")):y.showToast(S.FILE_SAVE_ERROR[D()]??"Error saving file",d.getAssetIDByName("ic_close_circle"))})},function(){e.clipboard.setString(a),y.showToast(b.Messages.COPIED+" "+b.Messages.SEARCH_ANSWER_HAS_LINK,d.getAssetIDByName("toast_copy_link"))}),render:function(){return r.content?H:c},headerTitle:function(){let s=T(m.theme,h.semanticColors.HEADER_PRIMARY);return e.React.createElement(p,{onPress:function(){e.clipboard.setString(u),y.showToast(b.Messages.COPIED_TEXT,d.getAssetIDByName("toast_copy_message"))}},e.React.createElement(_,{numberOfLines:1,style:{color:s}},u),e.React.createElement(_,{numberOfLines:1,style:{color:s,fontSize:12}},J.intword(f,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")))}}}})}}const ue=n.findByStoreName("MessageStore"),le=n.findByStoreName("SelectedChannelStore");function ce(){return I.after("render",n.findByName("Chat").prototype,function(u,a){a.props.hasOwnProperty("onTapInviteEmbed")&&I.before("onTapInviteEmbed",a.props,function(f){let[{nativeEvent:{index:o,messageId:r}}]=f,i=le.getChannelId(),c=ue.getMessage(i,r),R=c.codedLinks,M=c.attachments;if(o>=R.length){let w=o-R.length,E=M[w];$.pushModal({key:"file-content-preview",modal:{key:"file-content-preview",modal:se(E.filename,E.url,E.size),animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}})})}const de=n.findByName("RowManager"),ge=n.findByProps("Messages"),{getLocale:fe}=n.findByProps("getLocale");function Re(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"? bytes";return{borderColor:-251658241,backgroundColor:-13947599,thumbnailCornerRadius:15,headerColor:-4867391,headerText:"",acceptLabelBackgroundColor:-14441126,titleText:ge.Messages.SEARCH_ANSWER_HAS_ATTACHMENT.toUpperCase()+" \u2014 "+a,type:null,extendedType:4,participantAvatarUris:[],acceptLabelText:S.PREVIEW[fe()]??"Preview",noParticipantsText:`
`+u,ctaEnabled:!0}}function he(){return I.after("generate",de.prototype,function(u,a){let[f]=u,{message:o}=a;if(f.rowType!=1||!o.attachments)return;let r=[],i=[];o.attachments.forEach(function(c){c.filename.toLowerCase().endsWith(".txt")?r.push(Re(c.filename,c.size)):i.push(c)}),r.length&&(o.codedLinks.push(...r),o.attachments=i)})}const{StyleSheet:Ee,PanResponder:pe}=e.ReactNative,k=n.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:O}}=n.findByProps("colors","meta"),{View:F}=B.General,{useState:ye,useRef:Be}=e.React,U={sliderOff:O(k.theme,h.semanticColors.DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND),sliderOn:O(k.theme,h.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND),thumb:O(k.theme,h.semanticColors.MENTION_FOREGROUND)},Ce=function(u){let{onSlide:a,value:f}=u;const o=f||0,[r,i]=ye(0),c=Be(null);function R(t){c.current&&c.current.measure(function(l,j,W,P,v,Y){let z=(t-v)/(W-v)*100;const H=Math.min(Math.max(0,Math.round(z/5)*5),100);a&&a(H)})}const M=e.React.useRef(pe.create({onStartShouldSetPanResponder:function(t,l){return!0},onStartShouldSetPanResponderCapture:function(t,l){return!0},onMoveShouldSetPanResponder:function(t,l){return!0},onMoveShouldSetPanResponderCapture:function(t,l){return!0},onPanResponderGrant:function(t,l){R(l.x0)},onPanResponderMove:function(t,l){R(l.moveX)},onPanResponderTerminationRequest:function(t,l){return!0},onPanResponderRelease:function(t,l){},onPanResponderTerminate:function(t,l){},onShouldBlockNativeResponder:function(t,l){return!0}})).current;function w(t){i(t.nativeEvent.layout.width)}const E=Ee.create({container:{marginLeft:"5%",width:"90%",height:20,borderRadius:25,backgroundColor:U.sliderOff,marginBottom:25},slid:{width:o+"%",height:"100%",borderTopLeftRadius:25,borderBottomLeftRadius:25,borderRadius:o===100?25:0,backgroundColor:U.sliderOn,justifyContent:"center"},thumb:{height:"150%",aspectRatio:1,alignSelf:"flex-end",right:-(r/2),borderRadius:100,backgroundColor:U.thumb}});return e.React.createElement(F,{style:E.container,...M.panHandlers,ref:c},e.React.createElement(F,{style:E.slid},e.React.createElement(F,{style:E.thumb,onLayout:w})))},{ScrollView:Se}=e.ReactNative,{Text:be}=B.General,me=n.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:Te}}=n.findByProps("colors","meta"),_e={text:Te(me.theme,h.semanticColors.TEXT_NORMAL)},Pe=n.findByProps("intword");function ve(){q.useProxy(C.storage),C.storage.chunkSize??=60928;let u=1024e3,a=10240,f=function(i){return i/100*(u-a)+a},o=function(i){return(i-a)/(u-a)*100},r=function(i){return Pe.intword(i,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")};return React.createElement(Se,{style:{flex:1,marginTop:10}},React.createElement(X.FormRow,{label:"Load chunk size",subLabel:"How many bytes to load at a time"}),React.createElement(Ce,{onSlide:function(i){C.storage.chunkSize=f(i)},value:o(C.storage.chunkSize),style:{marginBottom:0}}),React.createElement(be,{style:{marginLeft:"5%",color:_e.text,fontFamily:e.constants.Fonts.DISPLAY_MEDIUM,fontSize:16,marginBottom:5,marginTop:-5}},"Current value: ",`${r(C.storage.chunkSize)} (${Math.round(o(C.storage.chunkSize))}%)`))}let G=[];var Ae={onLoad:function(){G.push(ce()),G.push(he())},onUnload:function(){for(const u of G)u()},settings:ve};return x.default=Ae,Object.defineProperty(x,"__esModule",{value:!0}),x})({},vendetta.metro,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.plugin,vendetta.ui.components.Forms,vendetta.storage);
