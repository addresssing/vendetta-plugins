(function(v,n,b,c,u,p,e,A){"use strict";const g=n.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:f}}=n.findByProps("colors","meta"),{View:T,Text:y,TouchableOpacity:m}=A.General,{FormIcon:I}=A.Forms,{ActivityIndicator:M,ScrollView:P}=e.ReactNative,k=e.ReactNative.NativeModules.MediaManager.downloadMediaAsset,{default:D,getRenderCloseButton:O}=n.findByProps("getRenderCloseButton"),L=n.findByProps("pushModal"),x=n.findByProps("intword"),H=n.findByName("Svg",!1).default,w=n.findByName("Svg",!1).Path;function U(a){return function(){return e.React.createElement(m,{onPress:a},e.React.createElement(I,{source:u.getAssetIDByName("ic_download_24px"),style:{marginRight:8,marginLeft:-8,opacity:1}}))}}function W(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"https://cdn.discordapp.com/attachments/1068304660269641738/1144843403151020122/file.txt",d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return function(){const[r,h]=e.React.useState("");let o=1e4;const[t,_]=e.React.useState(o),[R,C]=e.React.useState({content:"",loadedBytes:o});R.loadedBytes===o&&fetch(l,{headers:{Range:"bytes=0-"+String(o)}}).then(function(s){s.ok?s.text().then(function(S){C({content:S,loadedBytes:R.loadedBytes})}):C({content:"",loadedBytes:0})});let B=e.React.createElement(T,{style:{margin:32}},e.React.createElement(M,{size:"large"}));const[E,j]=e.React.useState(!1),i={header:f(g.theme,c.semanticColors.HEADER_PRIMARY),test:f(g.theme,c.semanticColors.TEXT_MUTED),bgDark:f(g.theme,c.semanticColors.BACKGROUND_SECONDARY_ALT),bgBright:f(g.theme,c.semanticColors.BACKGROUND_SECONDARY),bgBrighter:f(g.theme,c.semanticColors.BACKGROUND_ACCENT)},X=e.React.createElement(H,{height:"24",width:"24",viewBox:"0 0 24 24",fill:E?i.header:i.test},e.React.createElement(w,{d:"M2.75 5C2.33579 5 2 5.33579 2 5.75C2 6.16421 2.33579 6.5 2.75 6.5H21.25C21.6642 6.5 22 6.16421 22 5.75C22 5.33579 21.6642 5 21.25 5H2.75Z"}),e.React.createElement(w,{d:"M2.75 11.5C2.33579 11.5 2 11.8358 2 12.25C2 12.6642 2.33579 13 2.75 13H19C20.3807 13 21.5 14.1193 21.5 15.5C21.5 16.8807 20.3807 18 19 18H14.5607L15.2803 17.2803C15.5732 16.9874 15.5732 16.5126 15.2803 16.2197C14.9874 15.9268 14.5126 15.9268 14.2197 16.2197L12.2197 18.2197C11.9268 18.5126 11.9268 18.9874 12.2197 19.2803L14.2197 21.2803C14.5126 21.5732 14.9874 21.5732 15.2803 21.2803C15.5732 20.9874 15.5732 20.5126 15.2803 20.2197L14.5607 19.5H19C21.2091 19.5 23 17.7091 23 15.5C23 13.2909 21.2091 11.5 19 11.5H2.75Z"}),e.React.createElement(w,{d:"M2 18.75C2 18.3358 2.33579 18 2.75 18H9.25C9.66421 18 10 18.3358 10 18.75C10 19.1642 9.66421 19.5 9.25 19.5H2.75C2.33579 19.5 2 19.1642 2 18.75Z"}));let q=e.React.createElement(e.React.Fragment,null,e.React.createElement(y,{style:{color:i.test,marginTop:7}},"+ ",x.intword(d-t,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")," not loaded."),e.React.createElement(m,{style:{backgroundColor:i.bgBright,borderRadius:5,padding:10,marginBottom:20,marginTop:5},onPress:function(){fetch(l,{headers:{Range:"bytes="+String(t)+"-"+String(t+o)}}).then(function(s){s.ok?s.text().then(function(S){C({content:r+S,loadedBytes:R.loadedBytes+o})}):p.showToast("Error: Network response was not ok",u.getAssetIDByName("ic_close_circle"))})}},e.React.createElement(y,{style:{color:i.header,textTransform:"uppercase",fontWeight:"bold",textAlign:"center",fontSize:20}},"Load more"))),$=e.React.createElement(T,{style:{marginTop:0}},e.React.createElement(T,{style:{padding:15,paddingBottom:0,display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}},e.React.createElement(m,{onPress:function(){j(!E)},onLongPress:function(){p.showToast("Toggle Word Wrap",u.getAssetIDByName("ic_information_filled_24px"))},style:{backgroundColor:E?i.bgBrighter:i.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:E?i.bgBright:i.bgDark}},X)),e.React.createElement(P,{style:{margin:15,marginBottom:50}},e.React.createElement(P,{horizontal:!E},e.React.createElement(y,{selectable:!0,style:{color:i.header}},r)),t<d&&q));return e.React.createElement(D,{initialRouteName:"FILE_CONTENT_PREVIEW",screens:{FILE_CONTENT_PREVIEW:{headerLeft:O(function(){return L.popModal("file-content-preview")}),headerRight:U(function(){k(l,0).then(function(s){s?p.showToast("Saved file",u.getAssetIDByName("ic_selection_checked_24px")):p.showToast("Error saving file",u.getAssetIDByName("ic_close_circle"))})}),render:function(){return r?$:B},headerTitle:function(){let s=f(g.theme,c.semanticColors.HEADER_PRIMARY);return e.React.createElement(m,{onPress:function(){e.clipboard.setString(a),p.showToast("Copied filename to clipboard",u.getAssetIDByName("toast_copy_message"))}},e.React.createElement(y,{numberOfLines:1,style:{color:s}},a),e.React.createElement(y,{numberOfLines:1,style:{color:s,fontSize:12}},x.intword(d,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")))}}}})}}const F=n.findByStoreName("MessageStore"),G=n.findByStoreName("SelectedChannelStore");function z(){return b.after("render",n.findByName("Chat").prototype,function(a,l){l.props.hasOwnProperty("onTapInviteEmbed")&&b.before("onTapInviteEmbed",l.props,function(d){let[{nativeEvent:{index:r,messageId:h}}]=d,o=G.getChannelId(),t=F.getMessage(o,h),_=t.codedLinks,R=t.attachments;if(r>=_.length){let C=r-_.length,B=R[C];L.pushModal({key:"file-content-preview",modal:{key:"file-content-preview",modal:W(B.filename,B.url,B.size),animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}})})}const K=n.findByName("RowManager");function V(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown";return{borderColor:-251658241,backgroundColor:-13947599,thumbnailCornerRadius:15,headerColor:-4867391,headerText:"",acceptLabelBackgroundColor:-14441126,titleText:"FILE \u2014 "+(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"? bytes"),type:null,extendedType:4,participantAvatarUris:[],acceptLabelText:"Preview",noParticipantsText:`
`+a,ctaEnabled:!0}}function Y(){return b.after("generate",K.prototype,function(a,l){let[d]=a,{message:r}=l;if(d.rowType!=1||!r.attachments)return;let h=[],o=[];r.attachments.forEach(function(t){t.filename.toLowerCase().endsWith(".txt")?h.push(V(t.filename,t.size)):o.push(t)}),h.length&&(r.codedLinks.push(...h),r.attachments=o)})}let N=[];var Z={onLoad:function(){N.push(z()),N.push(Y())},onUnload:function(){for(const a of N)a()}};return v.default=Z,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta.metro,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components);
