(function(p,d,y,r,C,T,a,s,b,S){"use strict";const{Text:w}=C.General,_=r.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:B}}=r.findByProps("colors","meta"),D=r.findByStoreName("UserStore"),A=r.findByStoreName("RelationshipStore"),x=r.findByStoreName("GuildMemberStore"),M=r.findByProps("TYPING_WRAPPER_HEIGHT");function P(){return y.after("default",M,function(e,i){let[{channel:o}]=e;if(!i||a.storage.hideTyping)return;const c=i.props?.children,g=B(_.theme,T.semanticColors.HEADER_SECONDARY),h=y.after("type",c,function(u,f){d.React.useEffect(function(){return function(){h()}},[]);const n=f?.props?.children?.[0]?.props?.children?.[1]?.props;if(!n||!n.children||n.children==="Several people are typing...")return;const t=M.useTypingUserIds(o.id).map(function(l){const m=x.getMember(o.guild_id,l),v=D.getUser(l),J=m?.nick||A.getNickname(l)||v.globalName||v.username,z=m?.colorString||g;return{displayName:J,displayColor:z}});function I(l){return d.React.createElement(w,{style:{color:l.displayColor,fontFamily:d.constants.Fonts.DISPLAY_BOLD}},l.displayName)}!t||t.length<1||(n.children=t.length===1?[I(t[0])," is typing..."]:[...t.slice(0,t.length-1).flatMap(function(l,m){return[I(l),m<t.length-2?", ":" and "]}),I(t[t.length-1])," are typing..."])})})}const{DCDChatManager:L}=d.ReactNative.NativeModules,F=r.findByStoreName("GuildMemberStore"),G=r.findByStoreName("SelectedChannelStore"),O=r.findByStoreName("ChannelStore");function R(e,i){if(e)return Array.isArray(e.content)&&e.content.forEach(function(o,c){return e.content[c]=R(o,i)}),e.type&&(e=i(e)||e),e}function U(){return y.before("updateRows",L,function(e){if(a.storage.noMention)return;let i=JSON.parse(e[1]);i.forEach(function(o){if(o.type!=1||!o.message?.content)return;const c=G.getChannelId();if(!c)return;const g=O.getChannel(c);if(!g.guild_id)return;const h=function(u){if(u.type!="mention"||!u.userId)return;const f=F.getMember(g.guild_id,u.userId)?.colorString;if(!f)return;const n=parseInt(f.slice(1),16);return{...u,roleColor:n,color:n,colorString:f}};R({content:o.message.content},h),o.message.referencedMessage?.message?.content&&R({content:o.message.referencedMessage.message.content},h)}),e[1]=JSON.stringify(i)})}console.log("d0"),console.log("d1");const V=r.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:Y}}=r.findByProps("colors","meta"),N={Typing:S.getAssetIDByName("ic_messages"),Mention:S.getAssetIDByName("ic_mention_user"),Text:S.getAssetIDByName("ic_add_text")},H={text:Y(V.theme,semanticColors.TEXT_NORMAL)};function W(e,i,o){const c=function(n){return n.match(/\w\w/g).map(function(t){return parseInt(t,16)})},g=function(n){return"#"+n.map(function(t){return t.toString(16).padStart(2,"0")}).join("")},h=c(e),u=c(i),f=h.map(function(n,t){return Math.round(n+(u[t]-n)*o)});return g(f)}function j(){return b.useProxy(a.storage),a.storage.chatInterpolation??=0,React.createElement(d.ReactNative.ScrollView,{style:{flex:1}},React.createElement(s.FormSection,{title:"Where to show the top role color?",titleStyleType:"no_border"},React.createElement(s.FormSwitchRow,{label:"Show in typing",subLabel:"Display the top role color in the typing bar.",leading:React.createElement(s.FormIcon,{source:N.Typing}),value:!a.storage.hideTyping,onValueChange:function(e){return a.storage.hideTyping=!e}}),React.createElement(s.FormSwitchRow,{label:"Show in mentions",subLabel:"Display the top role color in mentions in the chat.",leading:React.createElement(s.FormIcon,{source:N.Mention}),value:!a.storage.noMention,onValueChange:function(e){return a.storage.noMention=!e}}),React.createElement(s.FormSwitchRow,{label:"Show in chat text",subLabel:"Display the top role color in the chat text... Why would you want this?",leading:React.createElement(s.FormIcon,{source:N.Typing}),value:a.storage.chatInterpolation>0,onValueChange:function(e){a.storage.chatInterpolation=e?100:0}}),React.createElement(Text,{style:{marginLeft:"5%",color:W(H.text,"#ff0000",uwu/100),fontFamily:d.constants.Fonts.DISPLAY_MEDIUM,fontSize:16,marginBottom:5,marginTop:-5}},"Color interpolation (for chat text):")))}let E=[];var k={onLoad:function(){E.push(P()),E.push(U())},onUnload:function(){for(const e of E)e()},settings:j};return p.default=k,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta.ui.components,vendetta.ui,vendetta.plugin,vendetta.ui.components.Forms,vendetta.storage,vendetta.ui.assets);
