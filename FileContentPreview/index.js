(function(A,t,N,h,E,p,e,v,B,H,V){"use strict";var T={PREVIEW:{"en-US":"Preview","en-GB":"Preview","zh-CN":"\u9884\u89C8","zh-TW":"\u9810\u89BD",ch:"N\xE1hled",da:"L\xE6s fil",nl:"Voorbeeld",fr:"Aper\xE7u",de:"Vorschau",el:"\u03B4\u03B9\u03B1\u03B2\u03AC\u03C3\u03B5\u03C4\u03B5","es-ES":"Leer",uk:"\u0447\u0438\u0442\u0430\u0442\u0438"},FILE_SAVED:{"en-US":"File saved","en-GB":"File saved","es-ES":"Archivo guardado",uk:"\u0424\u0430\u0439\u043B \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E"},FILE_SAVE_ERROR:{"en-US":"Error saving file","en-GB":"Error saving file","es-ES":"Error guardando archivo",uk:"\u041F\u043E\u043C\u0438\u043B\u043A\u0430 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043D\u044F \u0444\u0430\u0439\u043B\u0443"},TOGGLE_WORD_WRAP:{"en-US":"Toggle Word Wrap","en-GB":"Toggle Word Wrap","es-ES":"Salto de l\xEDnea",uk:"\u041F\u0435\u0440\u0435\u043C\u0438\u043A\u0430\u0447 \u0430\u0432\u0442\u043E\u043F\u0435\u0440\u0435\u043D\u043E\u0441\u0443 \u0441\u043B\u043E\u0432"}};const _=t.findByProps("Messages"),{getLocale:w}=t.findByProps("getLocale"),y=t.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:C}}=t.findByProps("colors","meta"),{View:M,Text:S,TouchableOpacity:b}=v.General,{FormIcon:$}=v.Forms,{ActivityIndicator:K,ScrollView:G}=e.ReactNative,Y=e.ReactNative.NativeModules.MediaManager.downloadMediaAsset,{default:X,getRenderCloseButton:j}=t.findByProps("getRenderCloseButton"),W=t.findByProps("pushModal"),F=t.findByProps("intword"),Z=t.findByName("Svg",!1).default,L=t.findByName("Svg",!1).Path,q=t.findByProps("useSafeAreaInsets");function Q(s,n){return function(){return e.React.createElement(b,{onPress:s,onLongPress:n},e.React.createElement($,{source:E.getAssetIDByName("ic_download_24px"),style:{marginRight:8,marginLeft:-8,opacity:1}}))}}function J(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"https://cdn.discordapp.com/attachments/1068304660269641738/1144843403151020122/file.txt",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return function(){let r=B.storage.chunkSize||60928;const[a,o]=e.React.useState({content:"",loadedBytes:r,firstTime:!0});a.firstTime&&fetch(n,{headers:{Range:"bytes=0-"+String(r)}}).then(function(c){c.ok?c.text().then(function(P){o({content:P,loadedBytes:a.loadedBytes,firstTime:!1})}):o({content:"",loadedBytes:0,firstTime:!1})});let d=e.React.createElement(M,{style:{margin:32}},e.React.createElement(K,{size:"large"}));const[g,m]=e.React.useState(!1),u={header:C(y.theme,h.semanticColors.HEADER_PRIMARY),test:C(y.theme,h.semanticColors.TEXT_MUTED),bgDark:C(y.theme,h.semanticColors.BACKGROUND_SECONDARY_ALT),bgBright:C(y.theme,h.semanticColors.BACKGROUND_SECONDARY),bgBrighter:C(y.theme,h.semanticColors.BACKGROUND_ACCENT)},R=e.React.createElement(Z,{height:"24",width:"24",viewBox:"0 0 24 24",fill:g?u.header:u.test},e.React.createElement(L,{d:"M2.75 5C2.33579 5 2 5.33579 2 5.75C2 6.16421 2.33579 6.5 2.75 6.5H21.25C21.6642 6.5 22 6.16421 22 5.75C22 5.33579 21.6642 5 21.25 5H2.75Z"}),e.React.createElement(L,{d:"M2.75 11.5C2.33579 11.5 2 11.8358 2 12.25C2 12.6642 2.33579 13 2.75 13H19C20.3807 13 21.5 14.1193 21.5 15.5C21.5 16.8807 20.3807 18 19 18H14.5607L15.2803 17.2803C15.5732 16.9874 15.5732 16.5126 15.2803 16.2197C14.9874 15.9268 14.5126 15.9268 14.2197 16.2197L12.2197 18.2197C11.9268 18.5126 11.9268 18.9874 12.2197 19.2803L14.2197 21.2803C14.5126 21.5732 14.9874 21.5732 15.2803 21.2803C15.5732 20.9874 15.5732 20.5126 15.2803 20.2197L14.5607 19.5H19C21.2091 19.5 23 17.7091 23 15.5C23 13.2909 21.2091 11.5 19 11.5H2.75Z"}),e.React.createElement(L,{d:"M2 18.75C2 18.3358 2.33579 18 2.75 18H9.25C9.66421 18 10 18.3358 10 18.75C10 19.1642 9.66421 19.5 9.25 19.5H2.75C2.33579 19.5 2 19.1642 2 18.75Z"}));let i=e.React.createElement(e.React.Fragment,null,e.React.createElement(S,{style:{color:u.test,marginTop:7}},"+ ",F.intword(f-a.loadedBytes,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")," not loaded."),e.React.createElement(b,{style:{backgroundColor:u.bgBright,borderRadius:5,padding:10,marginBottom:20,marginTop:5},onPress:function(){fetch(n,{headers:{Range:"bytes="+String(a.loadedBytes+1)+"-"+String(a.loadedBytes+r)}}).then(function(c){c.ok?c.text().then(function(P){o({content:a.content+P,loadedBytes:a.loadedBytes+r,firstTime:!1})}):p.showToast("Error: Network response was not ok",E.getAssetIDByName("ic_close_circle"))})}},e.React.createElement(S,{style:{color:u.header,textTransform:"uppercase",fontWeight:"bold",textAlign:"center",fontSize:20}},_.Messages.VOICE_PANEL_LOAD_MORE)));const l=q.useSafeAreaInsets();let U=e.React.createElement(M,{style:{marginTop:0}},e.React.createElement(M,{style:{padding:15,paddingBottom:0,display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}},e.React.createElement(b,{onPress:function(){m(!g)},onLongPress:function(){p.showToast(T.TOGGLE_WORD_WRAP[w()]??"Toggle Word Wrap",E.getAssetIDByName("ic_information_filled_24px"))},style:{backgroundColor:g?u.bgBrighter:u.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:g?u.bgBright:u.bgDark}},R)),e.React.createElement(G,{style:{margin:15,marginBottom:50+l.bottom}},e.React.createElement(G,{horizontal:!g},e.React.createElement(S,{selectable:!0,style:{color:u.header}},a.content)),a.loadedBytes<f&&i));return e.React.createElement(X,{initialRouteName:"FILE_CONTENT_PREVIEW",screens:{FILE_CONTENT_PREVIEW:{headerLeft:j(function(){return W.popModal("file-content-preview")}),headerRight:Q(function(){Y(n,0).then(function(c){c?p.showToast(T.FILE_SAVED[w()]??"File saved",E.getAssetIDByName("ic_selection_checked_24px")):p.showToast(T.FILE_SAVE_ERROR[w()]??"Error saving file",E.getAssetIDByName("ic_close_circle"))})},function(){e.clipboard.setString(n),p.showToast(_.Messages.COPIED+" "+_.Messages.SEARCH_ANSWER_HAS_LINK,E.getAssetIDByName("toast_copy_link"))}),render:function(){return a.content?U:d},headerTitle:function(){let c=C(y.theme,h.semanticColors.HEADER_PRIMARY);return e.React.createElement(b,{onPress:function(){e.clipboard.setString(s),p.showToast(_.Messages.COPIED_TEXT,E.getAssetIDByName("toast_copy_message"))}},e.React.createElement(S,{numberOfLines:1,style:{color:c}},s),e.React.createElement(S,{numberOfLines:1,style:{color:c,fontSize:12}},F.intword(f,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")))}}}})}}const ee=t.findByStoreName("MessageStore"),te=t.findByStoreName("SelectedChannelStore");function ne(){return N.after("render",t.findByName("Chat").prototype,function(s,n){n.props.hasOwnProperty("onTapInviteEmbed")&&N.before("onTapInviteEmbed",n.props,function(f){let[{nativeEvent:{index:r,messageId:a}}]=f,o=te.getChannelId(),d=ee.getMessage(o,a),g=d.codedLinks,m=d.attachments;if(r>=g.length){let u=r-g.length,R=m[u];W.pushModal({key:"file-content-preview",modal:{key:"file-content-preview",modal:J(R.filename,R.url,R.size),animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}})})}const ae=t.findByName("RowManager"),re=t.findByProps("Messages"),{getLocale:oe}=t.findByProps("getLocale");function se(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"? bytes";return{borderColor:-251658241,backgroundColor:-13947599,thumbnailCornerRadius:15,headerColor:-4867391,headerText:"",acceptLabelBackgroundColor:-14441126,titleText:re.Messages.SEARCH_ANSWER_HAS_ATTACHMENT.toUpperCase()+" \u2014 "+n,type:null,extendedType:4,participantAvatarUris:[],acceptLabelText:T.PREVIEW[oe()]??"Preview",noParticipantsText:`
`+s,ctaEnabled:!0}}function ie(){return N.after("generate",ae.prototype,function(s,n){let[f]=s,{message:r}=n;if(f.rowType!=1||!r.attachments)return;let a=[],o=[];r.attachments.forEach(function(d){d.filename.toLowerCase().endsWith(".txt")?a.push(se(d.filename,d.size)):o.push(d)}),a.length&&(r.codedLinks.push(...a),r.attachments=o)})}const{StyleSheet:ue,PanResponder:le}=e.ReactNative,D=t.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:I}}=t.findByProps("colors","meta"),{View:O}=v.General,{useState:de,useRef:ce}=e.React,k={sliderOff:I(D.theme,h.semanticColors.DEPRECATED_QUICKSWITCHER_INPUT_BACKGROUND),sliderOn:I(D.theme,h.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND),thumb:I(D.theme,h.semanticColors.MENTION_FOREGROUND)},fe=function(s){let{onSlide:n,value:f}=s;const r=f||0,[a,o]=de(0),d=ce(null);function g(i){d.current&&d.current.measure(function(l,U,c,P,z,ve){let Se=(i-z)/(c-z)*100;const me=Math.min(Math.max(0,Math.round(Se/5)*5),100);n&&n(me)})}const m=e.React.useRef(le.create({onStartShouldSetPanResponder:function(i,l){return!0},onStartShouldSetPanResponderCapture:function(i,l){return!0},onMoveShouldSetPanResponder:function(i,l){return!0},onMoveShouldSetPanResponderCapture:function(i,l){return!0},onPanResponderGrant:function(i,l){g(l.x0)},onPanResponderMove:function(i,l){g(l.moveX)},onPanResponderTerminationRequest:function(i,l){return!0},onPanResponderRelease:function(i,l){},onPanResponderTerminate:function(i,l){},onShouldBlockNativeResponder:function(i,l){return!0}})).current;function u(i){o(i.nativeEvent.layout.width)}const R=ue.create({container:{marginLeft:"5%",width:"90%",height:20,borderRadius:25,backgroundColor:k.sliderOff,marginBottom:25},slid:{width:r+"%",height:"100%",borderTopLeftRadius:25,borderBottomLeftRadius:25,borderRadius:r===100?25:0,backgroundColor:k.sliderOn,justifyContent:"center"},thumb:{height:"150%",aspectRatio:1,alignSelf:"flex-end",right:-(a/2),borderRadius:100,backgroundColor:k.thumb}});return e.React.createElement(O,{style:R.container,...m.panHandlers,ref:d},e.React.createElement(O,{style:R.slid},e.React.createElement(O,{style:R.thumb,onLayout:u})))},{ScrollView:ge}=e.ReactNative,{Text:he}=v.General,Re=t.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:Ee}}=t.findByProps("colors","meta"),Be={text:Ee(Re.theme,h.semanticColors.TEXT_NORMAL)},pe=t.findByProps("intword");function ye(){V.useProxy(B.storage),B.storage.chunkSize??=60928;let s=1024e3,n=10240,f=function(o){return o/100*(s-n)+n},r=function(o){return(o-n)/(s-n)*100},a=function(o){return pe.intword(o,["bytes","KB","MB","GB","TB","PB"],1024,void 0,void 0,void 0," ")};return React.createElement(ge,{style:{flex:1,marginTop:10}},React.createElement(H.FormRow,{label:"Load chunk size",subLabel:"How many bytes to load at a time"}),React.createElement(fe,{onSlide:function(o){B.storage.chunkSize=f(o)},value:r(B.storage.chunkSize),style:{marginBottom:0}}),React.createElement(he,{style:{marginLeft:"5%",color:Be.text,fontFamily:e.constants.Fonts.DISPLAY_MEDIUM,fontSize:16,marginBottom:5,marginTop:-5}},"Current value: ",`${a(B.storage.chunkSize)} (${Math.round(r(B.storage.chunkSize))}%)`))}let x=[];var Ce={onLoad:function(){x.push(ne()),x.push(ie())},onUnload:function(){for(const s of x)s()},settings:ye};return A.default=Ce,Object.defineProperty(A,"__esModule",{value:!0}),A})({},vendetta.metro,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.plugin,vendetta.ui.components.Forms,vendetta.storage);
