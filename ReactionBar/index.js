(function(m,f,o,v,S,P){"use strict";const{View:C,TouchableOpacity:N}=S.General,{Image:A}=f.ReactNative,p=o.findByProps("addReaction","getReactors"),y=o.findByProps("canUseEmojisEverywhere","canUseAnimatedEmojis"),{getCustomEmojiById:h}=o.findByProps("getCustomEmojiById"),{convertNameToSurrogate:I}=o.findByProps("convertNameToSurrogate"),R=o.findByProps("can","_dispatcher"),E=o.findByProps("getGuilds"),b=o.findByStoreName("UserSettingsProtoStore"),T=o.findByStoreName("MessageStore"),U=o.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:_}}=o.findByProps("colors","meta"),B=function(e){const i={background:"BACKGROUND_SECONDARY",separator:"BACKGROUND_TERTIARY"};return i[e]?_(U.theme,P.semanticColors[i[e]]):"#FFFFFF"};function F(e){return Object.entries(e).sort(function(i,n){return n[1].score-i[1].score})}let O=F(b.frecencyWithoutFetchingLatest.emojiFrecency.emojis).map(function(e){let[i,n]=e;return i});const M=function(e){return R.can(f.constants.Permissions.ADD_REACTIONS,E.getGuild(e))};var c=[];function w(e){return c.push(e),c.splice(0,c.length-4),c}function D(e,i,n){let r=T.getMessage(e,i);if(!r)return;let u=r.reactions.filter(function(s){return s.me});console.log(u),console.log(n),u.find(function(s){return s.emoji.name===n.name&&s.emoji.id===n.id})?p.removeReactionWithConfirmation({channelId:e,messageId:i,emoji:{id:n.id,name:n.name},location:"Message",reactionType:0,isMe:!0}):p.addReaction(e,i,n,"Message",{burst:!1})}function G(){return v.after("default",o.findByName("ChatInputContextBar",!1),function(e,i){let[n]=e;if(!n.pendingReply)return;const r=n.pendingReply.channel.guild_id,u=n.pendingReply.channel.id,s=n.pendingReply.message.id;if(r&&!M(r))return;const l=c.find(function(t){return t.id===r}),g=l?l.emojis:O.filter(function(t){const a=h(t);return a?!(!y.canUseAnimatedEmojis()&&a.animated||a.guildId!=r&&(!R.can(f.constants.Permissions.USE_EXTERNAL_EMOJIS,E.getGuild(r))||!y.canUseEmojisEverywhere())):!0}).map(function(t){let a=I(t);if(a)return{uri:"asset:/emoji-"+Array.from(a).map(function(L){return L.codePointAt(0).toString(16)}).join("-")+".png",name:a,id:null,animated:!1};let d=h(t);if(d)return{uri:d.url,name:d.name,id:d.id,animated:d.animated}}).filter(function(t){return t!==void 0});l||w({id:r,emojis:g}),g.length&&i.props.children.unshift(React.createElement(C,{style:{backgroundColor:B("background"),width:"100%",padding:5,borderBottomColor:B("separator"),borderBottomWidth:1,display:"flex",flexDirection:"row"}},g.map(function(t){return React.createElement(N,{onPress:function(){return D(u,s,{id:t.id,name:t.name,animated:t.animated})}},React.createElement(A,{source:{uri:t.uri},style:{width:24,height:24,marginLeft:5,marginRight:5}}))})))})}let j=[];var k={onLoad:function(){j.push(G())},onUnload:function(){for(const e of j)e()}};return m.default=k,Object.defineProperty(m,"__esModule",{value:!0}),m})({},vendetta.metro.common,vendetta.metro,vendetta.patcher,vendetta.ui.components,vendetta.ui);
