(function(y,d,p,a,v,T,o,s,C,S){"use strict";const{Text:b}=v.General,_=a.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:B}}=a.findByProps("colors","meta"),D=a.findByStoreName("UserStore"),x=a.findByStoreName("RelationshipStore"),A=a.findByStoreName("GuildMemberStore"),M=a.findByProps("TYPING_WRAPPER_HEIGHT");function P(){return p.after("default",M,function(e,i){let[{channel:r}]=e;if(!i||o.storage.hideTyping)return;const c=i.props?.children,h=B(_.theme,T.semanticColors.HEADER_SECONDARY),g=p.after("type",c,function(u,f){d.React.useEffect(function(){return function(){g()}},[]);const n=f?.props?.children?.[0]?.props?.children?.[1]?.props;if(!n||!n.children||n.children==="Several people are typing...")return;const t=M.useTypingUserIds(r.id).map(function(l){const m=A.getMember(r.guild_id,l),w=D.getUser(l),J=m?.nick||x.getNickname(l)||w.globalName||w.username,z=m?.colorString||h;return{displayName:J,displayColor:z}});function E(l){return d.React.createElement(b,{style:{color:l.displayColor,fontFamily:d.constants.Fonts.DISPLAY_BOLD}},l.displayName)}!t||t.length<1||(n.children=t.length===1?[E(t[0])," is typing..."]:[...t.slice(0,t.length-1).flatMap(function(l,m){return[E(l),m<t.length-2?", ":" and "]}),E(t[t.length-1])," are typing..."])})})}const{DCDChatManager:L}=d.ReactNative.NativeModules,G=a.findByStoreName("GuildMemberStore"),F=a.findByStoreName("SelectedChannelStore"),O=a.findByStoreName("ChannelStore");function I(e,i){if(e)return Array.isArray(e.content)&&e.content.forEach(function(r,c){return e.content[c]=I(r,i)}),e.type&&(e=i(e)||e),e}function U(){return p.before("updateRows",L,function(e){if(o.storage.noMention)return;let i=JSON.parse(e[1]);i.forEach(function(r){if(r.type!=1||!r.message?.content)return;const c=F.getChannelId();if(!c)return;const h=O.getChannel(c);if(!h.guild_id)return;const g=function(u){if(u.type!="mention"||!u.userId)return;const f=G.getMember(h.guild_id,u.userId)?.colorString;if(!f)return;const n=parseInt(f.slice(1),16);return{...u,roleColor:n,color:n,colorString:f}};I({content:r.message.content},g),r.message.referencedMessage?.message?.content&&I({content:r.message.referencedMessage.message.content},g)}),e[1]=JSON.stringify(i)})}const{Text:V}=v.General,Y=a.findByStoreName("ThemeStore"),{meta:{resolveSemanticColor:$}}=a.findByProps("colors","meta"),R={Typing:S.getAssetIDByName("ic_messages"),Mention:S.getAssetIDByName("ic_mention_user"),Text:S.getAssetIDByName("ic_add_text")},H={text:$(Y.theme,semanticColors.TEXT_NORMAL)};function W(e,i,r){const c=function(n){return n.match(/\w\w/g).map(function(t){return parseInt(t,16)})},h=function(n){return"#"+n.map(function(t){return t.toString(16).padStart(2,"0")}).join("")},g=c(e),u=c(i),f=g.map(function(n,t){return Math.round(n+(u[t]-n)*r)});return h(f)}function j(){return C.useProxy(o.storage),React.createElement(d.ReactNative.ScrollView,{style:{flex:1}},React.createElement(s.FormSection,{title:"Where to show the top role color?",titleStyleType:"no_border"},React.createElement(s.FormSwitchRow,{label:"Show in typing",subLabel:"Display the top role color in the typing bar.",leading:React.createElement(s.FormIcon,{source:R.Typing}),value:!o.storage.hideTyping,onValueChange:function(e){return o.storage.hideTyping=!e}}),React.createElement(s.FormSwitchRow,{label:"Show in mentions",subLabel:"Display the top role color in mentions in the chat.",leading:React.createElement(s.FormIcon,{source:R.Mention}),value:!o.storage.noMention,onValueChange:function(e){return o.storage.noMention=!e}}),React.createElement(s.FormSwitchRow,{label:"Show in chat text",subLabel:"Display the top role color in the chat text... Why would you want this?",leading:React.createElement(s.FormIcon,{source:R.Typing}),value:o.storage.chatInterpolation>0,onValueChange:function(e){o.storage.chatInterpolation=e?100:0}}),React.createElement(V,{style:{marginLeft:"5%",color:W(H.text,"#ff0000",uwu/100),fontFamily:d.constants.Fonts.DISPLAY_MEDIUM,fontSize:16,marginBottom:5,marginTop:-5}},"Color interpolation (for chat text):"),React.createElement(Swidew,{onSlide:function(e){o.storage.chatInterpolation=e},value:o.storage.chatInterpolation})))}let N=[];var k={onLoad:function(){C.useProxy(o.storage),o.storage.chatInterpolation??=0,N.push(P()),N.push(U())},onUnload:function(){for(const e of N)e()},settings:j};return y.default=k,Object.defineProperty(y,"__esModule",{value:!0}),y})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta.ui.components,vendetta.ui,vendetta.plugin,vendetta.ui.components.Forms,vendetta.storage,vendetta.ui.assets);
